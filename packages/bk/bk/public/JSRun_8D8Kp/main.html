<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="robots" content="noindex, nofollow"/>
    <meta name="googlebot" content="noindex, nofollow"/>
    <meta id="viewport" name="viewport"
          content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
    <title>选座demo - JSRUN 驱动</title>

    <script type="text/javascript" src="" ></script>
        <script type="text/javascript" src="http://cdn.bootcss.com/vue/2.2.1/vue.js"></script>
        <script type="text/javascript" src="http://h5rsc.vipstatic.com/ams/element-ui@2.4.8.js"></script>
        <link rel="stylesheet" type="text/css" href="http://h5rsc.vipstatic.com/ams/element-ui@2.4.8.css"/>
    <link rel="stylesheet" type="text/css" href="main.css"/>

</head>
<body>
<div class="app" id="app">
  <div class="cover-wrapper" @touchend="moving = false" v-loading="isLoading" element-loading-text="场馆刷新中">
    <!-- 小地图 -->
    <div class="mini-map" v-if="showMiniMap">
      <div class="mini-map-wrap" ref="miniMap" :style="`height: ${mapHeight + 2}px`">
        <div class="seat-box" :style="
            `width: ${containerWidth}px; height: ${containerHeight}px; transform: scale(${widthCalc});transform-origin: 0 0;zoom: 1;`
          ">
          <ul v-for="(item, i) in rowArr" class="rows" :class="[{ side: item.isSide }]" :style="
              `background-color: ${!item.isSide &&
                areaColors[item.area]}`
            " :key="i">
            <template v-for="(item2, i2) in item.cols">
              <li v-if="!item2.isSide" class="seat-item" :class="{
                  checked: item2.checked,
                  unchecked: !item2.checked,
                  disabled: item2.disabled,
                  solded: item2.solded,
                  opacity0: !item2.seatId
                }" :key="i2"></li>
              <li v-else class="side" :key="i2"></li>
            </template>
          </ul>
        </div>
      </div>
      <div class="loop" :style="
          `width: ${(scaleWidth * mapWidth) / zoom}px;
          height: ${(scaleHeight * mapHeight) / zoom}px;
          margin-left: ${(scrollLeft * scaleMoveX) / zoom}px;
          margin-top: ${(scrollTop * scaleMoveY) / zoom}px;`
        " @touchstart="touchstartHandle" @touchmove="touchmoveHandle"></div>
    </div>
    <!-- 选座区域 -->
    <div class="venue-box">
      <!-- 行数与座位类型提示 -->
      <div class="bay-number" ref="bayNumber">
        <div class="bay" :class="{ side: item.isSide }" v-for="(item, i) in rowArr" :style="`zoom: ${zoom}`" :key="i">
          {{ item.isSide ? "" : getIndex(i) }}
          <span v-if="item.isSide">{{ item.area }}：{{ item.number.value }}</span>
        </div>
      </div>
      <!-- 选座 -->
      <div class="seat-wrap" style="scale: 2" ref="seatWrap" @scroll="scrollHandle">
        <div class="seat-box" ref="seatBox" id="seatBox" :style="
            `width: ${containerWidth}px; height: ${containerHeight}px; zoom: ${zoom}`
          ">
          <template v-for="(item, i) in rowArr">
            <ul class="rows" :class="[{ side: item.isSide }]" :style="
                `background-color: ${!item.isSide &&
                  areaColors[item.area]}`
              " :key="i">
              <template v-for="(item2, i2) in item.cols">
                <li v-if="!item2.isSide" class="seat-item" :class="{
                    checked: item2.checked,
                    unchecked: !item2.checked,
                    disabled: item2.disabled,
                    solded: item2.solded,
                    opacity0: !item2.seatId
                  }" :key="i2" @click="seatChangeHandle(item2)"></li>
                <li v-else class="side" :key="i2"></li>
              </template>
            </ul>
          </template>
        </div>
      </div>
    </div>

    <!-- 座位类型提示，已选座位信息 -->
    <div class="ticket-info">
      <ul class="legend-wrap">
        <li class="unchecked">可选</li>
        <li class="checked">已选</li>
        <li class="solded">已售</li>
        <!-- <li class="disabled">不可售</li> -->
      </ul>
      <div class="activity-wrap">
        <div class="header" @click="isExpand = !isExpand">
          <div class="title">点击展开查看售票</div>
          <i class="el-icon-arrow-down" :class="{
              expand: isExpand
            }"></i>
        </div>
        <div class="check-seat-wrap" :class="{ expand: isExpand }">
          <div class="check-seat-scroll-wrap">
            <div class="seat-ticket" v-for="(item, i) in checkedList" :key="i" @click="item.checked = false">
              <div class="title">
                {{ item.area }} {{ item.row }}排{{
                  item.col
                }}座
              </div>
              <div class="price">￥ {{ item.price }}</div>
              <i class="el-icon-close"></i>
            </div>
          </div>
        </div>
      </div>
      <el-button v-if="checkedList.length" type="warning" round @click="commitHandle">￥{{ totalPirce }} 确认选座</el-button>
      <el-button v-else type="warning" disabled round>请先选座</el-button>
    </div>
  </div>
</div>

<script type="application/javascript" src="main.js"></script>
</body>
</html>

